<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Aiaxcart Premium Shop</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <style>
        :root {
            --primary: #FFB0B5;
            --secondary: #FFD3D6;
            --dark: #382f2c;
            --light: #fefaf7;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--light);
            color: var(--dark);
        }
        
        .navbar-brand {
            font-weight: 700;
            color: var(--primary);
        }
        
        .card {
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.05);
            border: none;
            transition: transform 0.2s;
            margin-bottom: 1.5rem;
            background: white;
        }
        
        .card:hover {
            transform: translateY(-5px);
        }
        
        .category-tab {
            cursor: pointer;
            padding: 10px 20px;
            border-radius: 30px;
            margin: 0 5px;
            transition: all 0.3s;
            font-weight: 500;
            background: white;
        }
        
        .category-tab.active {
            background-color: var(--primary);
            color: white;
        }
        
        .product-card {
            height: 100%;
        }
        
        .product-img {
            height: 120px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2.5rem;
            color: var(--primary);
        }
        
        .toast {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 9999;
            min-width: 300px;
        }
        
        .buyer-profile-img {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background-color: var(--primary);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.8rem;
            font-weight: bold;
            margin: 0 auto 15px;
        }
        
        .order-status {
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
        }
        
        .status-pending {
            background-color: #fff3cd;
            color: #856404;
        }
        
        .status-confirmed {
            background-color: #d1ecf1;
            color: #0c5460;
        }
        
        .status-delivered {
            background-color: #d4edda;
            color: #155724;
        }
        
        .status-cancelled {
            background-color: #f8d7da;
            color: #721c24;
        }
        
        .tab-content {
            padding: 20px 0;
        }
        
        .hidden {
            display: none;
        }
        
        .modal-content {
            border-radius: 12px;
            border: none;
        }
        
        .modal-header {
            background-color: var(--primary);
            color: white;
            border-radius: 12px 12px 0 0;
        }
        
        .btn-primary {
            background-color: var(--primary);
            border-color: var(--primary);
            color: white;
        }
        
        .btn-primary:hover {
            background-color: #ff9da3;
            border-color: #ff9da3;
        }
        
        .form-control:focus, .form-select:focus {
            border-color: var(--primary);
            box-shadow: 0 0 0 0.25rem rgba(255, 176, 181, 0.25);
        }
        
        .feedback-avatar {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background-color: var(--primary);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 1.2rem;
        }
        
        .nav-link.active {
            background-color: var(--primary) !important;
            color: white !important;
        }
        
        @media (max-width: 768px) {
            .category-tab {
                padding: 8px 15px;
                font-size: 0.9rem;
            }
        }
    </style>
</head>
<body>
    <!-- Toast Notifications -->
    <div id="toastContainer" class="toast-container position-fixed top-0 end-0 p-3"></div>

    <!-- Buyer Site -->
    <div id="buyerSite">
        <!-- Navigation -->
        <nav class="navbar navbar-expand-lg navbar-light shadow-sm" style="background: #FFD3D6;">
            <div class="container">
                <a class="navbar-brand" href="#">
                    <i class="fas fa-shopping-cart me-2"></i>Aiaxcart Premium Shop
                </a>
                <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse" id="navbarNav">
                    <ul class="navbar-nav me-auto">
                        <li class="nav-item">
                            <a class="nav-link active" href="#" data-section="home">Home</a>
                        </li>
                        <!-- Add this to the navigation section in index.html -->
                        <li class="nav-item">
                            <a class="nav-link" href="admin.html">Admin</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#" data-section="rules">Rules</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#" data-section="feedback">Feedback</a>
                        </li>
                    </ul>
                    <div class="d-flex align-items-center">
                        <div id="userAuth" class="hidden">
                            <button class="btn btn-outline-primary me-2" id="loginBtn">Login</button>
                            <button class="btn btn-primary" id="signupBtn">Sign Up</button>
                        </div>
                        <div id="userProfile" class="hidden">
                            <div class="dropdown">
                                <button class="btn btn-outline-primary dropdown-toggle" type="button" id="userDropdown" data-bs-toggle="dropdown">
                                    <i class="fas fa-user me-1"></i> <span id="userName">User</span>
                                </button>
                                <ul class="dropdown-menu">
                                    <li><a class="dropdown-item" href="#" data-section="profile">My Account</a></li>
                                    <li><a class="dropdown-item" href="#" data-section="orders">My Orders</a></li>
                                    <li><a class="dropdown-item" href="#" data-section="report">Report Issue</a></li>
                                    <li><hr class="dropdown-divider"></li>
                                    <li><a class="dropdown-item text-danger" href="#" id="logoutBtn">Logout</a></li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </nav>

        <!-- Main Content -->
        <div class="container my-4">
            <!-- Home Section -->
            <div id="homeSection" class="section">
                <div class="d-flex justify-content-between align-items-center mb-4">
                    <h2>Premium Accounts</h2>
                    <div class="d-flex overflow-auto pb-2">
                        <div class="category-tab active" data-category="all">All Products</div>
                        <div class="category-tab" data-category="entertainment">Entertainment</div>
                        <div class="category-tab" data-category="streaming">Streaming</div>
                        <div class="category-tab" data-category="educational">Educational</div>
                        <div class="category-tab" data-category="editing">Editing</div>
                        <div class="category-tab" data-category="ai">AI</div>
                    </div>
                </div>
                
                <div id="productsContainer" class="row">
                    <!-- Products will be loaded here -->
                </div>
            </div>

            <!-- Rules Section -->
            <div id="rulesSection" class="section hidden">
                <h2 class="mb-4">Shop Rules</h2>
                <div id="rulesContainer">
                    <!-- Rules will be loaded here -->
                </div>
            </div>

            <!-- Feedback Section -->
            <div id="feedbackSection" class="section hidden">
                <div class="d-flex justify-content-between align-items-center mb-4">
                    <h2>Customer Feedback</h2>
                    <button class="btn btn-primary" id="addFeedbackBtn">
                        <i class="fas fa-plus me-1"></i> Add Feedback
                    </button>
                </div>
                
                <div class="row">
                    <div class="col-md-8">
                        <div id="feedbackList">
                            <!-- Feedback will be loaded here -->
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="card">
                            <div class="card-body">
                                <h5 class="card-title">Submit Feedback</h5>
                                <form id="feedbackForm">
                                    <div class="mb-3">
                                        <label for="feedbackName" class="form-label">Your Name</label>
                                        <input type="text" class="form-control" id="feedbackName" required>
                                    </div>
                                    <div class="mb-3">
                                        <label for="feedbackText" class="form-label">Your Feedback</label>
                                        <textarea class="form-control" id="feedbackText" rows="4" required></textarea>
                                    </div>
                                    <div class="mb-3">
                                        <label for="feedbackImage" class="form-label">Image (Optional)</label>
                                        <input type="file" class="form-control" id="feedbackImage" accept="image/*">
                                    </div>
                                    <button type="submit" class="btn btn-primary w-100">Submit Feedback</button>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Profile Section -->
            <div id="profileSection" class="section hidden">
                <h2 class="mb-4">My Account</h2>
                <div class="row">
                    <div class="col-md-4">
                        <div class="card">
                            <div class="card-body text-center">
                                <div class="buyer-profile-img" id="profileAvatar">JD</div>
                                <h4 id="profileName">John Doe</h4>
                                <p class="text-muted" id="profileEmail">john@example.com</p>
                                <button class="btn btn-outline-primary btn-sm">Edit Profile</button>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-8">
                        <ul class="nav nav-tabs" id="profileTabs">
                            <li class="nav-item">
                                <a class="nav-link active" data-bs-toggle="tab" href="#pendingOrders">Pending Orders</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" data-bs-toggle="tab" href="#confirmedOrders">Confirmed Orders</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" data-bs-toggle="tab" href="#deliveredAccounts">Delivered Accounts</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" data-bs-toggle="tab" href="#orderHistory">Order History</a>
                            </li>
                        </ul>
                        
                        <div class="tab-content mt-3">
                            <div class="tab-pane fade show active" id="pendingOrders">
                                <div id="pendingOrdersList">
                                    <!-- Pending orders will be loaded here -->
                                </div>
                            </div>
                            <div class="tab-pane fade" id="confirmedOrders">
                                <div id="confirmedOrdersList">
                                    <!-- Confirmed orders will be loaded here -->
                                </div>
                            </div>
                            <div class="tab-pane fade" id="deliveredAccounts">
                                <div id="deliveredAccountsList">
                                    <!-- Delivered accounts will be loaded here -->
                                </div>
                            </div>
                            <div class="tab-pane fade" id="orderHistory">
                                <div id="orderHistoryList">
                                    <!-- Order history will be loaded here -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Report Issue Section -->
            <div id="reportSection" class="section hidden">
                <h2 class="mb-4">Report an Issue</h2>
                <div class="row">
                    <div class="col-md-8">
                        <div class="card">
                            <div class="card-body">
                                <form id="reportForm">
                                    <div class="mb-3">
                                        <label for="reportOrderId" class="form-label">Order ID</label>
                                        <select class="form-select" id="reportOrderId" required>
                                            <option value="">Select an order</option>
                                            <!-- Order options will be populated here -->
                                        </select>
                                    </div>
                                    <div class="mb-3">
                                        <label for="reportProduct" class="form-label">Product Name</label>
                                        <input type="text" class="form-control" id="reportProduct" readonly>
                                    </div>
                                    <div class="mb-3">
                                        <label for="reportIssue" class="form-label">Issue Description</label>
                                        <textarea class="form-control" id="reportIssue" rows="4" required></textarea>
                                    </div>
                                    <div class="mb-3">
                                        <label for="reportScreenshot" class="form-label">Screenshot (Optional)</label>
                                        <input type="file" class="form-control" id="reportScreenshot" accept="image/*">
                                    </div>
                                    <button type="submit" class="btn btn-primary">Submit Report</button>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Product Modal -->
    <div class="modal fade" id="productModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="productModalTitle">Product Details</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <div class="col-md-6">
                            <div class="product-img mb-3">
                                <span id="productModalIcon">ðŸ“º</span>
                            </div>
                            <h4 id="productModalName">Product Name</h4>
                            <p id="productModalDescription" class="text-muted">Product description goes here.</p>
                            <div class="mb-3">
                                <label class="form-label">Available Stock</label>
                                <div class="fw-bold" id="availableStock">0</div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <form id="buyNowForm">
                                <div class="mb-3">
                                    <label for="accountType" class="form-label">Account Type</label>
                                    <select class="form-select" id="accountType" required>
                                        <option value="">Select account type</option>
                                    </select>
                                </div>
                                <div class="mb-3">
                                    <label for="duration" class="form-label">Duration</label>
                                    <select class="form-select" id="duration" required>
                                        <option value="">Select duration</option>
                                    </select>
                                </div>
                                <div class="mb-3">
                                    <label class="form-label">Price</label>
                                    <div class="fw-bold fs-4 text-primary" id="productPrice">â‚±0.00</div>
                                </div>
                                <div id="inviteEmailField" class="mb-3 hidden">
                                    <label for="gmail" class="form-label">Gmail Address</label>
                                    <input type="email" class="form-control" id="gmail" placeholder="Enter valid Gmail address">
                                </div>
                                <button type="submit" class="btn btn-primary w-100" id="checkoutBtn">Buy Now</button>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Checkout Modal -->
    <div class="modal fade" id="checkoutModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Checkout</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="checkoutForm">
                        <div class="mb-3">
                            <label for="paymentMethod" class="form-label">Payment Method</label>
                            <select class="form-select" id="paymentMethod" required>
                                <option value="">Select payment method</option>
                                <option value="gcash">GCash - 09625544105 (SMM)</option>
                                <option value="maya">Maya - 09298943629 (AF)</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label for="referenceNumber" class="form-label">Reference Number</label>
                            <input type="text" class="form-control" id="referenceNumber" placeholder="Enter reference number">
                        </div>
                        <div class="mb-3">
                            <label for="proofImage" class="form-label">Proof of Payment (Screenshot)</label>
                            <input type="file" class="form-control" id="proofImage" accept="image/*">
                        </div>
                        <div class="alert alert-info">
                            <small>After submitting, your order will be processed and you'll receive a confirmation.</small>
                        </div>
                        <button type="submit" class="btn btn-primary w-100">Submit Order</button>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- Login Modal -->
    <div class="modal fade" id="loginModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Login</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="loginForm">
                        <div class="mb-3">
                            <label for="loginEmail" class="form-label">Email</label>
                            <input type="email" class="form-control" id="loginEmail" required>
                        </div>
                        <div class="mb-3">
                            <label for="loginPassword" class="form-label">Password</label>
                            <input type="password" class="form-control" id="loginPassword" required>
                        </div>
                        <button type="submit" class="btn btn-primary w-100">Login</button>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- Signup Modal -->
    <div class="modal fade" id="signupModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Sign Up</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="signupForm">
                        <div class="mb-3">
                            <label for="signupName" class="form-label">Full Name</label>
                            <input type="text" class="form-control" id="signupName" required>
                        </div>
                        <div class="mb-3">
                            <label for="signupEmail" class="form-label">Email</label>
                            <input type="email" class="form-control" id="signupEmail" required>
                        </div>
                        <div class="mb-3">
                            <label for="signupPassword" class="form-label">Password</label>
                            <input type="password" class="form-control" id="signupPassword" required>
                        </div>
                        <div class="mb-3">
                            <label for="confirmPassword" class="form-label">Confirm Password</label>
                            <input type="password" class="form-control" id="confirmPassword" required>
                        </div>
                        <button type="submit" class="btn btn-primary w-100">Create Account</button>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Supabase Configuration
        const SUPABASE_URL = 'https://hnymqvkfmythdxtjqeam.supabase.co';
        const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImhueW1xdmtmbXl0aGR4dGpxZWFtIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjMxMjE3NTUsImV4cCI6MjA3ODY5Nzc1NX0.4ww5fKNnbhNzNrkJZLa466b6BsKE_yYMO2YH6-auFlI';
        
        // Initialize Supabase client
        const supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);
        
        // Application State
        let currentUser = null;
        let currentProduct = null;
        let currentOrderDetails = null;
        
        // Duration mapping
        const durationMap = {
            '7d': '7 Days',
            '14d': '14 Days', 
            '1m': '1 Month',
            '2m': '2 Months',
            '3m': '3 Months',
            '4m': '4 Months',
            '5m': '5 Months',
            '6m': '6 Months',
            '8m': '8 Months',
            '10m': '10 Months',
            '12m': '12 Months',
            '24m': '24 Months',
            'nw': 'No Warranty',
            '3m w': '3 Months Warranty',
            '6m w': '6 Months Warranty',
            '12m w': '12 Months Warranty'
        };

        // Complete product list with pricing
        const PRODUCTS_DATA = [
            // Entertainment
            { 
                id: 'netflix', 
                name: 'Netflix Premium', 
                category: 'entertainment', 
                icon: 'ðŸ“º',
                stock: 15,
                pricing: {
                    "solo profile": { '1m': 160, '2m': 280, '3m': 435, '4m': 565, '6m': 850, '8m': 1090, '12m': 1500 },
                    "shared profile": { '1m': 80, '2m': 145, '3m': 205, '4m': 270, '6m': 410, '8m': 520, '12m': 800 }
                }
            },
            { 
                id: 'viu', 
                name: 'Viu Premium', 
                category: 'entertainment', 
                icon: 'ðŸŽ¬',
                stock: 8,
                pricing: {
                    "solo account": { '1m': 70, '2m': 105, '3m': 145, '4m': 170, '6m': 205, '10m': 280, '12m': 310 },
                    "shared account": { '1m': 30, '2m': 55, '3m': 75, '4m': 90, '6m': 120, '10m': 190, '12m': 220 }
                }
            },
            { 
                id: 'viva-max', 
                name: 'VIVAMAX VIVAONE', 
                category: 'entertainment', 
                icon: 'ðŸŽ­',
                stock: 15,
                pricing: {
                    "solo account": { '1m': 110, '2m': 145, '3m': 170 },
                    "shared account": { '1m': 65, '2m': 90, '3m': 120 }
                }
            },
            { 
                id: 'wetv', 
                name: 'WeTV', 
                category: 'entertainment', 
                icon: 'ðŸ“±',
                stock: 8,
                pricing: {
                    "solo account": { '1m': 150 },
                    "shared account": { '1m': 55, '2m': 95, '3m': 135 }
                }
            },
            { 
                id: 'iwant-tfc', 
                name: 'IWANT TFC', 
                category: 'entertainment', 
                icon: 'ðŸ“º',
                stock: 8,
                pricing: {
                    "solo account": { '1m': 145 },
                    "shared account": { '1m': 50, '2m': 90, '3m': 125 }
                }
            },
            { 
                id: 'crunchyroll', 
                name: 'Crunchyroll', 
                category: 'entertainment', 
                icon: 'ðŸŽ®',
                stock: 10,
                pricing: {
                    "solo profile": { '1m': 75, '2m': 115, '3m': 160, '4m': 195 },
                    "shared profile": { '1m': 35, '2m': 60, '3m': 90, '4m': 115 }
                }
            },
            { 
                id: 'disney-plus', 
                name: 'Disney+', 
                category: 'entertainment', 
                icon: 'ðŸ¦',
                stock: 12,
                pricing: {
                    "solo account": { '1m': 390 },
                    "solo profile": { '1m': 160, '2m': 315, '4m': 630, '10m': 1480, '12m': 1700 },
                    "shared profile": { '1m': 85, '2m': 165, '4m': 330, '10m': 720, '12m': 880 }
                }
            },
            { 
                id: 'bilibili', 
                name: 'Bilibili', 
                category: 'entertainment', 
                icon: 'ðŸ“º',
                stock: 6,
                pricing: {
                    "shared account": { '1m': 45, '2m': 75, '3m': 105 }
                }
            },
            { 
                id: 'loklok', 
                name: 'Loklok', 
                category: 'entertainment', 
                icon: 'ðŸ“±',
                stock: 7,
                pricing: {
                    "solo account": { '1m': 150 },
                    "shared account": { '1m': 65, '2m': 115, '3m': 170 }
                }
            },
            { 
                id: 'iqiyi', 
                name: 'iQiyi', 
                category: 'entertainment', 
                icon: 'ðŸ“º',
                stock: 8,
                pricing: {
                    "shared account": { '1m': 50, '2m': 90, '3m': 135 }
                }
            },
            { 
                id: 'hbo-max', 
                name: 'HBO Max', 
                category: 'entertainment', 
                icon: 'ðŸ“¹',
                stock: 10,
                pricing: {
                    "solo account": { '1m': 240, '2m': 360, '3m': 480 },
                    "solo profile": { '1m': 135, '2m': 240, '3m': 350 },
                    "shared profile": { '1m': 70, '2m': 120, '3m': 170 }
                }
            },
            { 
                id: 'amazon-prime', 
                name: 'Amazon Prime', 
                category: 'entertainment', 
                icon: 'ðŸ›’',
                stock: 15,
                pricing: {
                    "solo account": { '1m': 80, '2m': 110, '3m': 135, '4m': 160, '5m': 185, '6m': 210 },
                    "solo profile": { '1m': 50, '2m': 80, '3m': 110, '4m': 135, '5m': 150, '6m': 170 },
                    "shared profile": { '1m': 30, '2m': 50, '3m': 70, '4m': 80, '5m': 90, '6m': 100 }
                }
            },
            { 
                id: 'youku', 
                name: 'Youku', 
                category: 'entertainment', 
                icon: 'ðŸ“º',
                stock: 6,
                pricing: {
                    "solo account": { '1m': 125 },
                    "shared account": { '1m': 50, '2m': 90, '3m': 125 }
                }
            },
            { 
                id: 'nba-league-pass', 
                name: 'NBA League Pass Premium', 
                category: 'entertainment', 
                icon: 'ðŸ€',
                stock: 5,
                pricing: {
                    "solo account": { '1m': 150 },
                    "shared account": { '1m': 75 }
                }
            },

            // Streaming (Music)
            { 
                id: 'youtube', 
                name: 'YouTube Premium', 
                category: 'streaming', 
                icon: 'ðŸ“¹',
                stock: 20,
                pricing: {
                    "famhead": { '1m': 70, '2m': 90, '3m': 125, '4m': 150, '5m': 175, '6m': 200 },
                    "solo": { '1m': 45, '2m': 60, '3m': 85, '4m': 105, '5m': 125, '6m': 145 },
                    "invite": { '1m': 20, '2m': 35, '3m': 50, '4m': 60, '5m': 70, '6m': 80 }
                }
            },
            { 
                id: 'spotify', 
                name: 'Spotify Premium', 
                category: 'streaming', 
                icon: 'ðŸŽµ',
                stock: 15,
                pricing: {
                    "solo fw": { '1m': 60, '2m': 110, '3m': 150, '4m': 200 },
                    "solo nw": { '1m': 45, '2m': 80, '3m': 120, '4m': 150 }
                }
            },
            { 
                id: 'apple-music', 
                name: 'Apple Music', 
                category: 'streaming', 
                icon: 'ðŸŽ§',
                stock: 12,
                pricing: {
                    "solo account": { '1m': 49, '2m': 89, '3m': 129, '4m': 159 }
                }
            },

            // AI Tools
            { 
                id: 'chatgpt', 
                name: 'ChatGPT Plus', 
                category: 'ai', 
                icon: 'ðŸ§ ',
                stock: 10,
                pricing: {
                    "solo account": { '1m': 600, '2m': 1050, '3m': 1500 },
                    "shared account": { '1m': 120, '2m': 200, '3m': 290 }
                }
            },
            { 
                id: 'blackbox-ai', 
                name: 'Blackbox AI', 
                category: 'ai', 
                icon: 'ðŸ¤–',
                stock: 0,
                pricing: {
                    "solo account": { '1m': 90, '2m': 170, '3m': 250 }
                }
            },
            { 
                id: 'perplexity', 
                name: 'Perplexity AI', 
                category: 'ai', 
                icon: 'ðŸ”',
                stock: 8,
                pricing: {
                    "solo account": { '1m': 120, '4m': 200, '6m': 250, '12m': 300, '24m': 450 },
                    "shared account": { '1m': 55, '4m': 140, '6m': 190, '12m': 230, '24m': 350 }
                }
            },
            { 
                id: 'google-one', 
                name: 'Google One + Gemini AI', 
                category: 'ai', 
                icon: 'â˜ï¸',
                stock: 10,
                pricing: {
                    "solo account": { '1m': 50, '2m': 85, '3m': 120, '12m': 280 },
                    "shared account": { '1m': 30, '2m': 50, '3m': 80, '12m': 150 }
                }
            },

            // Educational
            { 
                id: 'quizlet', 
                name: 'Quizlet+', 
                category: 'educational', 
                icon: 'ðŸ“š',
                stock: 6,
                pricing: {
                    "solo account": { '1m': 45, '2m': 65, '3m': 100 },
                    "shared account": { '1m': 20, '2m': 35, '3m': 50 }
                }
            },
            { 
                id: 'scribd', 
                name: 'Scribd Premium', 
                category: 'educational', 
                icon: 'ðŸ“–',
                stock: 7,
                pricing: {
                    "solo account": { '1m': 50, '2m': 85, '3m': 120 },
                    "shared account": { '1m': 30, '2m': 50, '3m': 80 }
                }
            },
            { 
                id: 'studocu', 
                name: 'Studocu Premium', 
                category: 'educational', 
                icon: 'ðŸŽ“',
                stock: 6,
                pricing: {
                    "solo account": { '1m': 50, '2m': 85, '3m': 120 },
                    "shared account": { '1m': 30, '2m': 50, '3m': 80 }
                }
            },
            { 
                id: 'duolingo', 
                name: 'Duolingo Super', 
                category: 'educational', 
                icon: 'ðŸ§‘â€ðŸŽ“',
                stock: 6,
                pricing: {
                    "solo account": { '1m': 80, '2m': 130, '3m': 170 }
                }
            },
            { 
                id: 'turnitin-student', 
                name: 'Turnitin Student', 
                category: 'educational', 
                icon: 'ðŸ“',
                stock: 8,
                pricing: {
                    "solo account": { '7d': 35, '14d': 50, '1m': 80, '2m': 140, '3m': 160, '6m': 330, '12m': 580 }
                }
            },
            { 
                id: 'turnitin-instructor', 
                name: 'Turnitin Instructor', 
                category: 'educational', 
                icon: 'ðŸ‘¨â€ðŸ«',
                stock: 5,
                pricing: {
                    "solo account": { '1m': 520 },
                    "shared account": { '7d': 120, '14d': 175, '1m': 280 }
                }
            },

            // Editing Tools
            { 
                id: 'canva', 
                name: 'Canva Pro', 
                category: 'editing', 
                icon: 'ðŸŽ¨',
                stock: 25,
                pricing: {
                    "edu lifetime": {'nw': 19, '3m w': 39, '6m w': 49, '12m w': 69},
                    "teamhead": {'1m': 45, '2m': 55, '3m': 65, '4m': 75, '5m': 85, '6m': 95},
                    "solo": { '1m': 25, '2m': 35, '3m': 45, '4m': 55, '5m': 65, '6m': 75 },
                    "invite": { '1m': 10, '2m': 15, '3m': 20, '4m': 25, '5m': 30, '6m': 35 }
                }
            },
            { 
                id: 'picsart', 
                name: 'Picsart Gold', 
                category: 'editing', 
                icon: 'ðŸ‘',
                stock: 12,
                pricing: {
                    "teamhead account": { '1m': 70, '2m': 115, '3m': 150 },
                    "solo account": { '1m': 50, '2m': 85, '3m': 120 },
                    "shared account": { '1m': 25, '2m': 45, '3m': 70 }
                }
            },
            { 
                id: 'capcut', 
                name: 'CapCut Pro', 
                category: 'editing', 
                icon: 'ðŸ“',
                stock: 10,
                pricing: {
                    "solo account": { '7d': 50, '1m': 130, '2m': 190, '3m': 240 },
                    "shared account": { '1m': 70, '2m': 120, '3m': 155 }
                }
            },
            { 
                id: 'alight-motion', 
                name: 'Alight Motion Pro', 
                category: 'editing', 
                icon: 'ðŸ“±',
                stock: 8,
                pricing: {
                    "solo account": { '1m': 90, '12m': 149 },
                    "shared account": { '1m': 35, '12m': 69 }
                }
            },
            { 
                id: 'remini', 
                name: 'Remini Web', 
                category: 'editing', 
                icon: 'âœ¨',
                stock: 6,
                pricing: {
                    "solo account": { '7d': 30, '1m': 50 },
                    "shared account": { '7d': 15, '1m': 25 }
                }
            },
            { 
                id: 'grammarly', 
                name: 'Grammarly Premium', 
                category: 'educational', 
                icon: 'âœï¸',
                stock: 8,
                pricing: {
                    "solo account": { '1m': 85 },
                    "shared account": { '1m': 35, '2m': 65, '3m': 95 }
                }
            },
            { 
                id: 'quillbot', 
                name: 'Quillbot Premium', 
                category: 'educational', 
                icon: 'ðŸ“',
                stock: 8,
                pricing: {
                    "solo account": { '1m': 100 },
                    "shared account": { '1m': 45, '2m': 75, '3m': 110 }
                }
            },
            { 
                id: 'ms-365', 
                name: 'Microsoft 365', 
                category: 'educational', 
                icon: 'ðŸ¤¬',
                stock: 15,
                pricing: {
                    "solo account": { '1m': 55, '2m': 90, '3m': 120 },
                    "shared account": { '1m': 25, '2m': 45, '3m': 65 }
                }
            },
            { 
                id: 'cams-canner', 
                name: 'CamScanner Pro', 
                category: 'editing', 
                icon: 'ðŸ“',
                stock: 8,
                pricing: {
                    "solo account": { '1m': 100, '2m': 180, '3m': 250 },
                    "shared account": { '1m': 50, '2m': 90, '3m': 120 }
                }
            },
            { 
                id: 'small-pdf', 
                name: 'Small PDF Pro', 
                category: 'editing', 
                icon: 'ðŸ“',
                stock: 7,
                pricing: {
                    "solo account": { '1m': 55, '2m': 95, '3m': 130 },
                    "shared account": { '1m': 30, '2m': 50, '3m': 70 }
                }
            },
            { 
                id: 'zoom', 
                name: 'Zoom Pro', 
                category: 'educational', 
                icon: 'ðŸ“½ï¸',
                stock: 6,
                pricing: {
                    "solo account": { '14d': 45, '1m': 70, '2m': 120, '3m': 160 }
                }
            }
        ];

        // Initialize the application
        document.addEventListener('DOMContentLoaded', function() {
            initializeApp();
            setupEventListeners();
            loadInitialData();
        });
        
        function initializeApp() {
            // Check if user is logged in
            const userData = localStorage.getItem('aiaxcart_user');
            if (userData) {
                currentUser = JSON.parse(userData);
                showUserProfile();
            } else {
                showUserAuth();
            }
            
            // Show home section by default
            showSection('homeSection');
        }
        
        function setupEventListeners() {
            // Navigation
            document.querySelectorAll('[data-section]').forEach(link => {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    const sectionId = this.getAttribute('data-section') + 'Section';
                    showSection(sectionId);
                });
            });
            
            // Category tabs
            document.querySelectorAll('.category-tab').forEach(tab => {
                tab.addEventListener('click', function() {
                    document.querySelectorAll('.category-tab').forEach(t => t.classList.remove('active'));
                    this.classList.add('active');
                    const category = this.getAttribute('data-category');
                    filterProducts(category);
                });
            });
            
            // User authentication
            document.getElementById('loginBtn').addEventListener('click', showLoginModal);
            document.getElementById('signupBtn').addEventListener('click', showSignupModal);
            document.getElementById('logoutBtn').addEventListener('click', handleLogout);
            
            // Product modal form
            document.getElementById('buyNowForm').addEventListener('submit', function(e) {
                e.preventDefault();
                handleBuyNow();
            });
            
            // Checkout form
            document.getElementById('checkoutForm').addEventListener('submit', function(e) {
                e.preventDefault();
                handleCheckout();
            });
            
            // Feedback form
            document.getElementById('feedbackForm').addEventListener('submit', function(e) {
                e.preventDefault();
                submitFeedback();
            });
            
            // Report form
            document.getElementById('reportForm').addEventListener('submit', function(e) {
                e.preventDefault();
                submitReport();
            });
            
            // Login form
            document.getElementById('loginForm').addEventListener('submit', function(e) {
                e.preventDefault();
                handleLogin();
            });
            
            // Signup form
            document.getElementById('signupForm').addEventListener('submit', function(e) {
                e.preventDefault();
                handleSignup();
            });
        }
        
        function loadInitialData() {
            loadProducts();
            loadRules();
            loadFeedback();
        }
        
        // UI Functions
        function showSection(sectionId) {
            document.querySelectorAll('.section').forEach(section => {
                section.classList.add('hidden');
            });
            document.getElementById(sectionId).classList.remove('hidden');
            
            // Update active nav link
            document.querySelectorAll('.nav-link').forEach(link => {
                link.classList.remove('active');
            });
            
            const correspondingNav = document.querySelector(`[data-section="${sectionId.replace('Section', '')}"]`);
            if (correspondingNav) {
                correspondingNav.classList.add('active');
            }
        }
        
        function showUserAuth() {
            document.getElementById('userAuth').classList.remove('hidden');
            document.getElementById('userProfile').classList.add('hidden');
        }
        
        function showUserProfile() {
            document.getElementById('userAuth').classList.add('hidden');
            document.getElementById('userProfile').classList.remove('hidden');
            document.getElementById('userName').textContent = currentUser.name;
            
            // Update profile section
            document.getElementById('profileName').textContent = currentUser.name;
            document.getElementById('profileEmail').textContent = currentUser.email;
            document.getElementById('profileAvatar').textContent = getInitials(currentUser.name);
            
            // Load user orders
            loadUserOrders();
        }
        
        function showLoginModal() {
            const loginModal = new bootstrap.Modal(document.getElementById('loginModal'));
            loginModal.show();
        }
        
        function showSignupModal() {
            const signupModal = new bootstrap.Modal(document.getElementById('signupModal'));
            signupModal.show();
        }
        
        function showToast(message, type = 'info') {
            const toast = document.createElement('div');
            toast.className = `toast align-items-center text-bg-${type === 'error' ? 'danger' : type} border-0`;
            toast.setAttribute('role', 'alert');
            toast.innerHTML = `
                <div class="d-flex">
                    <div class="toast-body">${message}</div>
                    <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast"></button>
                </div>
            `;
            
            document.getElementById('toastContainer').appendChild(toast);
            const bsToast = new bootstrap.Toast(toast);
            bsToast.show();
            
            toast.addEventListener('hidden.bs.toast', function() {
                toast.remove();
            });
        }
        
        // Authentication Functions
        async function handleLogin() {
            const email = document.getElementById('loginEmail').value;
            const password = document.getElementById('loginPassword').value;
            
            try {
                // Simulate login - in real app, use Supabase Auth
                const user = {
                    id: 1,
                    name: email.split('@')[0],
                    email: email
                };
                
                currentUser = user;
                localStorage.setItem('aiaxcart_user', JSON.stringify(user));
                
                // Save to Supabase buyers table
                await saveBuyerToSupabase(user);
                
                showUserProfile();
                bootstrap.Modal.getInstance(document.getElementById('loginModal')).hide();
                showToast('Login successful!', 'success');
                
            } catch (error) {
                showToast('Login failed. Please try again.', 'error');
            }
        }
        
        async function handleSignup() {
            const name = document.getElementById('signupName').value;
            const email = document.getElementById('signupEmail').value;
            const password = document.getElementById('signupPassword').value;
            const confirmPassword = document.getElementById('confirmPassword').value;
            
            if (password !== confirmPassword) {
                showToast('Passwords do not match', 'error');
                return;
            }
            
            try {
                const user = {
                    id: Date.now(),
                    name: name,
                    email: email
                };
                
                currentUser = user;
                localStorage.setItem('aiaxcart_user', JSON.stringify(user));
                
                // Save to Supabase buyers table
                await saveBuyerToSupabase(user);
                
                showUserProfile();
                bootstrap.Modal.getInstance(document.getElementById('signupModal')).hide();
                showToast('Account created successfully!', 'success');
                
            } catch (error) {
                showToast('Signup failed. Please try again.', 'error');
            }
        }
        
        function handleLogout() {
            currentUser = null;
            localStorage.removeItem('aiaxcart_user');
            showUserAuth();
            showToast('Logged out successfully', 'success');
        }
        
        // Data Functions
        function loadProducts() {
            try {
                displayProducts(PRODUCTS_DATA);
            } catch (error) {
                console.error('Error loading products:', error);
                showToast('Error loading products', 'error');
            }
        }
        
        function displayProducts(products) {
            const container = document.getElementById('productsContainer');
            container.innerHTML = '';
            
            products.forEach(product => {
                // Calculate minimum price
                let minPrice = Number.MAX_SAFE_INTEGER;
                Object.values(product.pricing).forEach(priceTiers => {
                    Object.values(priceTiers).forEach(price => {
                        if (price < minPrice) minPrice = price;
                    });
                });
                
                const col = document.createElement('div');
                col.className = 'col-md-4 col-lg-3 mb-4';
                col.innerHTML = `
                    <div class="card product-card" data-product-id="${product.id}">
                        <div class="card-body text-center">
                            <div class="product-img mb-3">
                                <span style="font-size: 2.5rem;">${product.icon}</span>
                            </div>
                            <h5 class="card-title">${product.name}</h5>
                            <p class="card-text text-muted small">${product.category}</p>
                            <div class="d-flex justify-content-between align-items-center">
                                <span class="badge bg-secondary">${product.category}</span>
                                <span class="text-primary fw-bold">From â‚±${minPrice}</span>
                            </div>
                            <div class="mt-2">
                                <small class="text-muted">Stock: ${product.stock}</small>
                            </div>
                            <button class="btn btn-primary btn-sm mt-3 w-100 view-product-btn" ${product.stock === 0 ? 'disabled' : ''}>
                                ${product.stock === 0 ? 'Out of Stock' : 'View Details'}
                            </button>
                        </div>
                    </div>
                `;
                container.appendChild(col);
            });
            
            // Add event listeners to view product buttons
            document.querySelectorAll('.view-product-btn').forEach(button => {
                button.addEventListener('click', function() {
                    const productId = this.closest('.card').getAttribute('data-product-id');
                    openProductModal(productId);
                });
            });
        }
        
        function filterProducts(category) {
            const productCards = document.querySelectorAll('.product-card');
            
            productCards.forEach(card => {
                if (category === 'all') {
                    card.style.display = 'block';
                } else {
                    const productCategory = card.querySelector('.badge').textContent.toLowerCase();
                    if (productCategory === category) {
                        card.style.display = 'block';
                    } else {
                        card.style.display = 'none';
                    }
                }
            });
        }
        
        function openProductModal(productId) {
            const product = PRODUCTS_DATA.find(p => p.id === productId);
            
            if (!product) {
                showToast('Product not found', 'error');
                return;
            }
            
            currentProduct = product;
            
            document.getElementById('productModalTitle').textContent = product.name;
            document.getElementById('productModalIcon').textContent = product.icon;
            document.getElementById('productModalName').textContent = product.name;
            document.getElementById('productModalDescription').textContent = `${product.category} - ${product.stock} in stock`;
            document.getElementById('availableStock').textContent = product.stock;
            
            // Populate account types
            const accountTypeSelect = document.getElementById('accountType');
            accountTypeSelect.innerHTML = '<option value="">Select account type</option>';
            
            Object.keys(product.pricing).forEach(accountType => {
                const option = document.createElement('option');
                option.value = accountType;
                option.textContent = accountType.charAt(0).toUpperCase() + accountType.slice(1);
                accountTypeSelect.appendChild(option);
            });
            
            // Populate durations based on selected account type
            accountTypeSelect.addEventListener('change', function() {
                const durationSelect = document.getElementById('duration');
                durationSelect.innerHTML = '<option value="">Select duration</option>';
                
                if (this.value) {
                    const durations = product.pricing[this.value];
                    Object.keys(durations).forEach(durationKey => {
                        const option = document.createElement('option');
                        option.value = durationKey;
                        option.textContent = durationMap[durationKey] || durationKey;
                        durationSelect.appendChild(option);
                    });
                }
                
                updatePrice();
            });
            
            // Update price when duration changes
            document.getElementById('duration').addEventListener('change', updatePrice);
            
            // Reset form and update invite field
            document.getElementById('buyNowForm').reset();
            updateInviteField();
            
            // Show modal
            const productModal = new bootstrap.Modal(document.getElementById('productModal'));
            productModal.show();
        }
        
        function updatePrice() {
            const accountType = document.getElementById('accountType').value;
            const duration = document.getElementById('duration').value;
            
            if (accountType && duration && currentProduct.pricing[accountType] && currentProduct.pricing[accountType][duration]) {
                const price = currentProduct.pricing[accountType][duration];
                document.getElementById('productPrice').textContent = `â‚±${price}`;
            } else {
                document.getElementById('productPrice').textContent = 'â‚±0.00';
            }
        }
        
        function updateInviteField() {
            const accountType = document.getElementById('accountType').value;
            if (accountType && accountType.toLowerCase().includes('invite')) {
                document.getElementById('inviteEmailField').classList.remove('hidden');
            } else {
                document.getElementById('inviteEmailField').classList.add('hidden');
            }
        }
        
        function handleBuyNow() {
            if (!currentUser) {
                showToast('Please login to continue', 'warning');
                return;
            }
            
            const accountType = document.getElementById('accountType').value;
            const duration = document.getElementById('duration').value;
            
            if (!accountType || !duration) {
                showToast('Please select account type and duration', 'warning');
                return;
            }
            
            // Validate invite email if needed
            if (accountType.toLowerCase().includes('invite')) {
                const gmail = document.getElementById('gmail').value;
                if (!gmail || !isValidGmail(gmail)) {
                    showToast('Please enter a valid Gmail address', 'warning');
                    return;
                }
            }
            
            // Get price
            const priceText = document.getElementById('productPrice').textContent;
            const price = parseFloat(priceText.replace('â‚±', ''));
            
            currentOrderDetails = {
                productId: currentProduct.id,
                productName: currentProduct.name,
                accountType: accountType,
                duration: duration,
                price: price,
                inviteEmail: document.getElementById('gmail').value || null
            };
            
            // Close product modal and open checkout
            bootstrap.Modal.getInstance(document.getElementById('productModal')).hide();
            const checkoutModal = new bootstrap.Modal(document.getElementById('checkoutModal'));
            checkoutModal.show();
        }
        
        async function handleCheckout() {
            const paymentMethod = document.getElementById('paymentMethod').value;
            const referenceNumber = document.getElementById('referenceNumber').value;
            const proofImage = document.getElementById('proofImage').files[0];
            
            if (!paymentMethod) {
                showToast('Please select a payment method', 'warning');
                return;
            }
            
            try {
                // Generate order ID
                const orderId = generateOrderId();
                
                // Create order object
                const order = {
                    id: orderId,
                    buyer_id: currentUser.id,
                    product_id: currentOrderDetails.productId,
                    account_type: currentOrderDetails.accountType,
                    duration: currentOrderDetails.duration,
                    price: currentOrderDetails.price,
                    payment_method: paymentMethod,
                    reference_number: referenceNumber,
                    invite_email: currentOrderDetails.inviteEmail,
                    status: 'pending',
                    created_at: new Date().toISOString()
                };
                
                // In real implementation, save to Supabase
                await saveOrderToSupabase(order);
                
                // Send Telegram notification
                await sendTelegramNotification(order);
                
                // Show success message
                bootstrap.Modal.getInstance(document.getElementById('checkoutModal')).hide();
                showToast(`Order submitted successfully! Your order ID is ${orderId}`, 'success');
                
                // Reset form
                document.getElementById('checkoutForm').reset();
                
                // Update user orders
                loadUserOrders();
                
            } catch (error) {
                console.error('Checkout error:', error);
                showToast('Error submitting order', 'error');
            }
        }
        
        function loadRules() {
            // Mock rules data
            const rules = [
                { id: 1, rule_text: 'All accounts are guaranteed to work for the duration purchased.', product_id: null },
                { id: 2, rule_text: 'Refunds are only provided if the account does not work within 24 hours of purchase.', product_id: null },
                { id: 3, rule_text: 'Sharing account details with others may result in suspension.', product_id: null }
            ];
            
            displayRules(rules);
        }
        
        function displayRules(rules) {
            const container = document.getElementById('rulesContainer');
            container.innerHTML = '';
            
            const generalRules = rules.filter(rule => !rule.product_id);
            
            if (generalRules.length > 0) {
                const generalCard = document.createElement('div');
                generalCard.className = 'card mb-4';
                generalCard.innerHTML = `
                    <div class="card-header bg-primary text-white">
                        <h5 class="mb-0">General Rules</h5>
                    </div>
                    <div class="card-body">
                        <ul class="list-group list-group-flush">
                            ${generalRules.map(rule => `<li class="list-group-item">${rule.rule_text}</li>`).join('')}
                        </ul>
                    </div>
                `;
                container.appendChild(generalCard);
            }
        }
        
        function loadFeedback() {
            // Mock feedback data
            const feedback = [
                { id: 1, buyer_name: 'John D.', feedback_text: 'Great service! My account works perfectly.', photo_url: null, created_at: '2023-05-15T10:30:00Z' },
                { id: 2, buyer_name: 'Sarah M.', feedback_text: 'Fast delivery and good support.', photo_url: null, created_at: '2023-05-10T14:22:00Z' },
                { id: 3, buyer_name: 'Mike T.', feedback_text: 'Had an issue but support resolved it quickly.', photo_url: null, created_at: '2023-05-05T09:15:00Z' }
            ];
            
            displayFeedback(feedback);
        }
        
        function displayFeedback(feedback) {
            const container = document.getElementById('feedbackList');
            container.innerHTML = '';
            
            feedback.forEach(item => {
                const feedbackItem = document.createElement('div');
                feedbackItem.className = 'card mb-3';
                feedbackItem.innerHTML = `
                    <div class="card-body">
                        <div class="d-flex">
                            <div class="feedback-avatar me-3">${getInitials(item.buyer_name)}</div>
                            <div class="flex-grow-1">
                                <h6 class="mb-1">${item.buyer_name}</h6>
                                <p class="mb-2">${item.feedback_text}</p>
                                ${item.photo_url ? `<img src="${item.photo_url}" class="img-fluid rounded mb-2" style="max-height: 200px;">` : ''}
                                <small class="text-muted">${formatDate(item.created_at)}</small>
                            </div>
                        </div>
                    </div>
                `;
                container.appendChild(feedbackItem);
            });
        }
        
        function submitFeedback() {
            const name = document.getElementById('feedbackName').value;
            const text = document.getElementById('feedbackText').value;
            const image = document.getElementById('feedbackImage').files[0];
            
            if (!name || !text) {
                showToast('Please fill in all required fields', 'warning');
                return;
            }
            
            // In real implementation, save to Supabase
            showToast('Feedback submitted successfully!', 'success');
            document.getElementById('feedbackForm').reset();
            loadFeedback();
        }
        
        function loadUserOrders() {
            // Mock orders data
            const orders = [
                { id: 'AXP-20230520-1234', product_name: 'Netflix Premium', account_type: 'Personal', duration: '1 Month', price: 199, status: 'pending', created_at: '2023-05-20T10:30:00Z' },
                { id: 'AXP-20230515-5678', product_name: 'Spotify Family', account_type: 'Family', duration: '3 Months', price: 449, status: 'confirmed', created_at: '2023-05-15T14:22:00Z' },
                { id: 'AXP-20230510-9012', product_name: 'Adobe Creative Cloud', account_type: 'Personal', duration: '1 Month', price: 299, status: 'delivered', created_at: '2023-05-10T09:15:00Z' }
            ];
            
            displayUserOrders(orders);
        }
        
        function displayUserOrders(orders) {
            const pendingContainer = document.getElementById('pendingOrdersList');
            const confirmedContainer = document.getElementById('confirmedOrdersList');
            const deliveredContainer = document.getElementById('deliveredAccountsList');
            const historyContainer = document.getElementById('orderHistoryList');
            
            pendingContainer.innerHTML = '';
            confirmedContainer.innerHTML = '';
            deliveredContainer.innerHTML = '';
            historyContainer.innerHTML = '';
            
            orders.forEach(order => {
                const orderElement = document.createElement('div');
                orderElement.className = 'card mb-3';
                orderElement.innerHTML = `
                    <div class="card-body">
                        <div class="d-flex justify-content-between align-items-start">
                            <div>
                                <h6 class="mb-1">${order.product_name}</h6>
                                <p class="mb-1 small">Order ID: ${order.id}</p>
                                <p class="mb-1 small">Account Type: ${order.account_type} â€¢ Duration: ${order.duration}</p>
                                <p class="mb-0 fw-bold">â‚±${order.price}</p>
                            </div>
                            <div>
                                <span class="order-status status-${order.status}">${order.status}</span>
                                <div class="mt-2">
                                    <small class="text-muted">${formatDate(order.created_at)}</small>
                                </div>
                            </div>
                        </div>
                        ${order.status === 'pending' ? `
                        <div class="mt-3">
                            <button class="btn btn-outline-danger btn-sm report-issue-btn" data-order-id="${order.id}">Report Issue</button>
                        </div>
                        ` : ''}
                    </div>
                `;
                
                if (order.status === 'pending') {
                    pendingContainer.appendChild(orderElement);
                } else if (order.status === 'confirmed') {
                    confirmedContainer.appendChild(orderElement);
                } else if (order.status === 'delivered') {
                    deliveredContainer.appendChild(orderElement);
                }
                
                // All orders go to history
                const historyElement = orderElement.cloneNode(true);
                historyContainer.appendChild(historyElement);
            });
            
            // Add event listeners to report issue buttons
            document.querySelectorAll('.report-issue-btn').forEach(button => {
                button.addEventListener('click', function() {
                    const orderId = this.getAttribute('data-order-id');
                    showReportSection(orderId);
                });
            });
        }
        
        function showReportSection(orderId) {
            showSection('reportSection');
            document.getElementById('reportOrderId').value = orderId;
        }
        
        function submitReport() {
            const orderId = document.getElementById('reportOrderId').value;
            const issue = document.getElementById('reportIssue').value;
            const screenshot = document.getElementById('reportScreenshot').files[0];
            
            if (!orderId || !issue) {
                showToast('Please fill in all required fields', 'warning');
                return;
            }
            
            // In real implementation, save to Supabase
            showToast('Report submitted successfully!', 'success');
            document.getElementById('reportForm').reset();
            showSection('profileSection');
        }
        
        // Utility Functions
        function getInitials(name) {
            return name.split(' ').map(part => part[0]).join('').toUpperCase();
        }
        
        function formatDate(dateString) {
            const date = new Date(dateString);
            return date.toLocaleDateString() + ' ' + date.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
        }
        
        function isValidGmail(email) {
            return /^[a-zA-Z0-9.]+@gmail\.com$/.test(email);
        }
        
        function generateOrderId() {
            const now = new Date();
            return `AXP-${now.getFullYear()}${(now.getMonth()+1).toString().padStart(2, '0')}${now.getDate().toString().padStart(2, '0')}-${Math.floor(1000 + Math.random() * 9000)}`;
        }
        
        // Supabase Integration Functions (Mock implementations)
        async function saveBuyerToSupabase(buyer) {
            console.log('Saving buyer to Supabase:', buyer);
            // await supabase.from('buyers').insert([buyer]);
        }
        
        async function saveOrderToSupabase(order) {
            console.log('Saving order to Supabase:', order);
            // await supabase.from('orders').insert([order]);
        }
        
        async function sendTelegramNotification(order) {
            const message = `
ðŸ›’ NEW ORDER RECEIVED!
Order ID: ${order.id}
Buyer: ${currentUser.email}
Product: ${currentOrderDetails.productName}
Account Type: ${order.account_type}
Duration: ${order.duration}
Price: â‚±${order.price}
Payment Method: ${order.payment_method}
            `;
            
            console.log('Sending Telegram notification:', message);
        }
    </script>
</body>
</html>
